<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Freea√ßa√≠ - Monte seu Pedido</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin:0; padding:0;
      background:#fafafa;
    }
    header {
      background: linear-gradient(135deg, #7a1fa2, #e040fb);
      color:#fff;
      padding:15px;
      text-align:center;
    }
    header img {
      max-height:60px;
    }
    main { padding:20px; }

    .summary {
      background:#fff;
      border-radius:10px;
      padding:15px;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
      margin-bottom:20px;
    }
    .summary h3 { margin-top:0; }
    .line {
      margin:10px 0;
    }
    .line span { display:block; }
    .price { font-weight:bold; color:#7a1fa2; }
    .btn-order {
      display:block;
      width:100%;
      padding:12px;
      margin-top:10px;
      border:none;
      border-radius:8px;
      background:linear-gradient(135deg, #7a1fa2, #e040fb);
      color:#fff;
      font-size:16px;
      cursor:pointer;
    }
    .btn-order:hover { opacity:0.9; }

    /* Modal flutuante */
    .modal {
      display:none;
      position:fixed;
      top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.6);
      z-index:999;
      justify-content:center;
      align-items:center;
      padding:20px;
    }
    .modal-content {
      background:#fff;
      border-radius:18px;
      max-width:520px;
      width:100%;
      padding:24px;
      position:relative;
      box-shadow:0 12px 40px rgba(0,0,0,0.3);
      animation:slideUp 0.3s ease;
    }
    .modal-content h2 { margin-top:0; color:#4b0073; }
    .close {
      position:absolute;
      top:12px; right:16px;
      font-size:28px;
      cursor:pointer;
      color:#666;
    }
    .modal-section { margin-bottom:20px; }
    .modal-section h3 { margin:0 0 10px; color:#333; }

    .sizes {
      display:flex;
      gap:10px;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .size-card {
      flex:1;
      text-align:center;
      border:2px solid #ddd;
      border-radius:10px;
      padding:10px;
      cursor:pointer;
    }
    .size-card.active {
      border-color:#7a1fa2;
      background:#f3e5f5;
    }
    .size-card img {
      max-width:60px;
      display:block;
      margin:0 auto 5px;
    }

    .radio-list label, .check-list label {
      display:block;
      margin-bottom:6px;
      cursor:pointer;
    }

    .modal-footer {
      text-align:center;
      padding-top:12px;
      border-top:1px solid #eee;
    }

    @media(max-width:600px){
      .modal-content { padding:16px; }
      .sizes { flex-wrap:wrap; justify-content:center; }
      .size-card { width:45%; }
    }

    @keyframes slideUp {
      from {transform:translateY(40px); opacity:0;}
      to {transform:translateY(0); opacity:1;}
    }

    .pedido-item {
      border-bottom:1px solid #eee;
      padding:8px 0;
    }
    .pedido-actions button {
      margin:0 2px;
      padding:5px 8px;
      font-size:12px;
    }
  </style>
</head>
<body>

<header>
  <h1>üçß Freea√ßa√≠</h1>
  <p>Monte seu pedido e receba em casa</p>
</header>

<main>
  <!-- Resumo do Pedido -->
  <div class="summary">
    <h3>Resumo do pedido</h3>
    <div id="lista-pedidos"></div>

    <div class="line"><span class="small">Nome do cliente</span><br><span id="res-nome">N√£o informado</span></div>
    <button class="btn-order" onclick="editarNome()">Editar Nome</button>

    <div class="line"><span class="small">Endere√ßo</span><br><span id="res-endereco">N√£o informado</span></div>
    <button class="btn-order" onclick="editarEndereco()">Editar Endere√ßo</button>

    <div class="line"><span class="small">Forma de Pagamento</span><br><span id="res-pagamento">N√£o informado</span></div>
    <button class="btn-order" onclick="editarPagamento()">Editar Pagamento</button>

    <button class="btn-order" style="background:#aaa;margin-bottom:8px;" onclick="novoPedido()">üóëÔ∏è Novo Pedido</button>

    <div class="line" style="margin-top:14px;">
      <span class="small">Total</span><br><span class="price" id="res-preco">R$ 0,00</span>
    </div>

    <button class="btn-order" onclick="finalizarPedido()">Enviar pedido pelo WhatsApp</button>
  </div>

  <!-- Bot√£o para abrir modal -->
  <button class="btn-order" onclick="abrirModal()">+ Adicionar A√ßa√≠</button>
</main>

<!-- Modal de Montagem -->
<div class="modal" id="pedidoModal">
  <div class="modal-content">
    <span class="close" onclick="fecharModal()">&times;</span>
    <h2>üçß Montar A√ßa√≠</h2>

    <!-- Passo 1: Tamanho -->
    <div class="step" id="step1">
      <h3>Escolha o Tamanho</h3>
      <div class="sizes">
        <div class="size-card" data-price="8" data-text="200 ml - R$ 8,00" onclick="selecionarTamanhoModal(this)">
          <img src="copo200.png" alt="200ml">
          <p>200 ml<br><small>R$ 8,00</small></p>
        </div>
        <div class="size-card active" data-price="10" data-text="300 ml - R$ 10,00" onclick="selecionarTamanhoModal(this)">
          <img src="copo300.png" alt="300ml">
          <p>300 ml<br><small>R$ 10,00</small></p>
        </div>
        <div class="size-card" data-price="12" data-text="400 ml - R$ 12,00" onclick="selecionarTamanhoModal(this)">
          <img src="copo400.png" alt="400ml">
          <p>400 ml<br><small>R$ 12,00</small></p>
        </div>
        <div class="size-card" data-price="14" data-text="500 ml - R$ 14,00" onclick="selecionarTamanhoModal(this)">
          <img src="copo500.png" alt="500ml">
          <p>500 ml<br><small>R$ 14,00</small></p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-order" onclick="proximoPasso(2)">Pr√≥ximo ‚û°Ô∏è</button>
      </div>
    </div>

    <!-- Passo 2: Fruta -->
    <div class="step" id="step2" style="display:none;">
      <h3>Escolha a Fruta</h3>
      <div class="radio-list">
        <label><input type="radio" name="modal-fruta" value="Uva" checked> Uva</label>
        <label><input type="radio" name="modal-fruta" value="Banana"> Banana</label>
        <label><input type="radio" name="modal-fruta" value="Morango"> Morango</label>
      </div>
      <div class="modal-footer">
        <button class="btn-order" style="background:#aaa" onclick="proximoPasso(1)">‚¨ÖÔ∏è Voltar</button>
        <button class="btn-order" onclick="proximoPasso(3)">Pr√≥ximo ‚û°Ô∏è</button>
      </div>
    </div>

    <!-- Passo 3: Adicionais -->
    <div class="step" id="step3" style="display:none;">
      <h3>Escolha os Adicionais</h3>
      <div class="check-list">
        <label><input type="checkbox" value="Leite em p√≥"> Leite em p√≥</label>
        <label><input type="checkbox" value="Castanhas"> Castanhas</label>
        <label><input type="checkbox" value="Leite condensado"> Leite condensado</label>
        <label><input type="checkbox" value="Pa√ßoca"> Pa√ßoca</label>
        <label><input type="checkbox" value="Granola"> Granola</label>
        <label><input type="checkbox" value="Flocos de arroz"> Flocos de arroz</label>
        <label><input type="checkbox" value="M&M colorido"> M&M colorido</label>
        <label><input type="checkbox" value="Amendoim"> Amendoim</label>
      </div>
      <div class="modal-footer">
        <button class="btn-order" style="background:#aaa" onclick="proximoPasso(2)">‚¨ÖÔ∏è Voltar</button>
        <button class="btn-order" onclick="confirmarAcai()">‚úÖ Confirmar A√ßa√≠</button>
      </div>
    </div>

  </div>
</div>

<script>
let pedidos = JSON.parse(localStorage.getItem("pedidos")) || [];
let enderecoEntrega = localStorage.getItem("enderecoEntrega") || "";
let nomeCliente = localStorage.getItem("nomeCliente") || "";
let formaPagamento = localStorage.getItem("formaPagamento") || "";
let precoAtual = 10;
let textoTamanho = "300 ml - R$ 10,00";

function abrirModal(){
  document.querySelectorAll(".step").forEach(s=>s.style.display="none");
  document.getElementById("step1").style.display="block";
  document.getElementById("pedidoModal").style.display="flex";
}
function fecharModal(){ document.getElementById("pedidoModal").style.display="none"; }

function selecionarTamanhoModal(el){
  document.querySelectorAll(".size-card").forEach(c=>c.classList.remove("active"));
  el.classList.add("active");
  precoAtual = parseFloat(el.dataset.price);
  textoTamanho = el.dataset.text;
}
function proximoPasso(n){
  document.querySelectorAll(".step").forEach(s=>s.style.display="none");
  document.getElementById("step"+n).style.display="block";
}
function confirmarAcai(){
  let fruta = document.querySelector('input[name="modal-fruta"]:checked').value;
  let adicionais = Array.from(document.querySelectorAll('#step3 input[type="checkbox"]:checked')).map(c=>c.value);

  pedidos.push({ tamanho:textoTamanho, fruta, adicionais, preco:precoAtual });
  salvar();
  atualizarResumo();
  fecharModal();
}

function atualizarResumo(){
  let lista = document.getElementById("lista-pedidos");
  lista.innerHTML="";
  let total=0;
  pedidos.forEach((p,i)=>{
    total+=p.preco;
    let div=document.createElement("div");
    div.className="pedido-item";
    div.innerHTML = `<b>${p.tamanho}</b> - ${p.fruta}<br>
      <small>${p.adicionais.join(", ")||"Sem adicionais"}</small><br>
      R$ ${p.preco.toFixed(2)}<br>
      <div class="pedido-actions">
        <button onclick="editarItem(${i})">‚úèÔ∏è Editar</button>
        <button onclick="duplicarItem(${i})">üìÑ Duplicar</button>
        <button onclick="excluirItem(${i})">‚ùå Excluir</button>
      </div>`;
    lista.appendChild(div);
  });
  document.getElementById("res-preco").innerText="R$ "+total.toFixed(2);
  document.getElementById("res-endereco").innerText=enderecoEntrega||"N√£o informado";
  document.getElementById("res-nome").innerText=nomeCliente||"N√£o informado";
  document.getElementById("res-pagamento").innerText=formaPagamento||"N√£o informado";
}

function editarItem(i){
  let p=pedidos[i];
  pedidos.splice(i,1);
  atualizarResumo();
  abrirModal();
}
function duplicarItem(i){ pedidos.push({...pedidos[i]}); salvar(); atualizarResumo(); }
function excluirItem(i){ pedidos.splice(i,1); salvar(); atualizarResumo(); }

function editarEndereco(){
  let novo=prompt("Digite o endere√ßo de entrega:", enderecoEntrega);
  if(novo!==null){ enderecoEntrega=novo; salvar(); atualizarResumo(); }
}
function editarNome(){
  let novo=prompt("Digite o nome do cliente:", nomeCliente);
  if(novo!==null){ nomeCliente=novo; salvar(); atualizarResumo(); }
}
function editarPagamento(){
  let novo=prompt("Forma de pagamento (Pix, Cart√£o, Esp√©cie):", formaPagamento);
  if(novo!==null){ formaPagamento=novo; salvar(); atualizarResumo(); }
}

function finalizarPedido(){
  if(pedidos.length==0){ alert("Adicione pelo menos um a√ßa√≠!"); return; }
  let mensagem="üçß *Pedido de A√ßa√≠* üçß\n\n";
  pedidos.forEach((p,i)=>{
    mensagem+=`*A√ßa√≠ ${i+1}:*\n${p.tamanho}\nFruta: ${p.fruta}\nAdicionais: ${p.adicionais.join(", ")||"Nenhum"}\nPre√ßo: R$ ${p.preco.toFixed(2)}\n\n`;
  });
  mensagem+=`*Cliente:* ${nomeCliente||"N√£o informado"}\n*Endere√ßo:* ${enderecoEntrega||"N√£o informado"}\n*Pagamento:* ${formaPagamento||"N√£o informado"}\n\n`;
  let total=pedidos.reduce((s,p)=>s+p.preco,0);
  mensagem+=`*Total:* R$ ${total.toFixed(2)}`;
  window.open("https://wa.me/5599984557326?text="+encodeURIComponent(mensagem), "_blank");
}

function novoPedido(){
  if(confirm("Tem certeza que deseja limpar o pedido?")){
    pedidos=[]; enderecoEntrega=""; nomeCliente=""; formaPagamento="";
    localStorage.clear();
    atualizarResumo();
  }
}

function salvar(){
  localStorage.setItem("pedidos", JSON.stringify(pedidos));
  localStorage.setItem("enderecoEntrega", enderecoEntrega);
  localStorage.setItem("nomeCliente", nomeCliente);
  localStorage.setItem("formaPagamento", formaPagamento);
}

atualizarResumo();
</script>

</body>
</html>