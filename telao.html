<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Telão — Placar Gincana (Realtime)</title>
<style>
  html,body{height:100%;margin:0}
  body{display:flex;align-items:center;justify-content:center;background:#081124;color:#fff;font-family:Inter,Arial,Helvetica,sans-serif}
  .grid{display:grid;gap:18px;width:95%;max-width:1600px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));padding:22px;border-radius:12px;display:flex;flex-direction:column;gap:8px}
  .name{font-size:1.6rem;font-weight:800}
  .score{font-size:4.5rem;font-weight:900}
  .sub{opacity:0.8}
  .topbar{position:fixed;left:18px;top:18px;color:#dbeafe;font-weight:700}
  .small{font-size:0.9rem;opacity:0.9}
</style>
</head>
<body>
  <div class="topbar">Placar — Gincana</div>
  <div id="grid" class="grid" role="list"></div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
  // mesma config que no admin
  const firebaseConfig = {
    apiKey: "AIzaSyA7YV4gp_vbnkbirg5ypG0Y8yASlNrfFNY",
    authDomain: "gincana-placar.firebaseapp.com",
    projectId: "gincana-placar",
    storageBucket: "gincana-placar.firebasestorage.app",
    messagingSenderId: "846259743430",
    appId: "1:846259743430:web:b9d1781e4a4ad6ab4145c7",
    measurementId: "G-3W641L1SJV"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const teamsCol = db.collection('teams');

  const grid = document.getElementById('grid');

  // realtime listener
  teamsCol.orderBy('score','desc').onSnapshot(snapshot=>{
    grid.innerHTML = '';
    if(snapshot.empty){
      grid.innerHTML = '<div style="color:#9aa3ad">Nenhuma equipe</div>'; return;
    }
    snapshot.forEach(doc=>{
      const t = doc.data();
      const card = document.createElement('div'); card.className='card';
      card.style.border = '2px solid rgba(255,255,255,0.04)';
      const name = document.createElement('div'); name.className='name'; name.textContent = t.name || 'Equipe';
      const score = document.createElement('div'); score.className='score'; score.textContent = (t.score||0);
      const sub = document.createElement('div'); sub.className='sub'; sub.textContent = t.emoji ? t.emoji + ' • ' + (t.color||'') : (t.color||'');
      card.appendChild(name); card.appendChild(score); card.appendChild(sub);
      grid.appendChild(card);
    });
  }, err => {
    console.error(err);
    grid.innerHTML = '<div style="color:#ffb4b4">Erro ao conectar ao Firebase. Verifique a configuração.</div>';
  });

  // Pressione F para fullscreen
  document.addEventListener('keydown', e=>{
    if(e.key.toLowerCase()==='f'){
      if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{});
    }
    if(e.key === 'Escape') {
      if(document.fullscreenElement) document.exitFullscreen().catch(()=>{});
    }
  });
  </script>
</body>
</html>